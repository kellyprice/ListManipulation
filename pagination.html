<html>
    <body>
        <style>
            .pagination-link {
                text-decoration: none;
                color: #0000ee;
            }
            .pagination-current {
                border: 1px solid #000;
                padding: 0 2px;
            }
        </style>
        <script>
            window.onload = function() {
                if (checkPage())
                    populatePagination();
            };
            function checkPage() {
                const myPagination = document.getElementById("myPagination");
                const currentPage = document.getElementById("CurrentPage");
                const pageCount = document.getElementById("PageCount");
                const delta = document.getElementById("Delta");
                let err = "";
                if (!currentPage) err = "Unable to use pagination as the field 'CurrentPage' does not exist.";
                else if (!pageCount) err = "Unable to use pagination as the field 'PageCount' does not exist.";
                else if (!Number.isInteger(parseInt(currentPage.value))) err = "Unable to use pagination as the value of 'CurrentPage' is not an integer.";
                else if (parseInt(currentPage.value) < 1) err = "Unable to use pagination as the value of 'CurrentPage' is less than 1.";
                else if (!Number.isInteger(parseInt(pageCount.value))) err = "Unable to use pagination as the value of 'PageCount' is not an integer.";
                else if (delta && !Number.isInteger(parseInt(delta.value))) err = "Unable to use pagination as the value of 'Delta' is not an integer.";
                myPagination.innerHTML = err;
                return err.length === 0;
            }
            function pagination(currentPage, pageCount) {
                const delta = document.getElementById("Delta") ? parseInt(document.getElementById("Delta").value) : 5;
                const separate = (a, b) => [a, ...({
                    0: [],
                    1: [b],
                    2: [a + 1, b],
                }[b - a] || ['.', b])]
                return Array(delta * 2 + 1)
                    .fill()
                    .map((_, index) => currentPage - delta + index)
                    .filter(page => 0 < page && page <= pageCount)
                    .flatMap((page, index, { length }) => {
                    if (!index) return separate(1, page)
                    if (index === length - 1) return separate(page, pageCount)
                    return [page]
                })
            }     
            function populatePagination() {
                const currentPage = parseInt(document.getElementById("CurrentPage").value);
                const pageCount = parseInt(document.getElementById("PageCount").value);
                let myPagination = document.getElementById("myPagination");
                myPagination.innerHTML = "";
                let pages = pagination(currentPage, pageCount);
                for (let i = 0; i < pages.length; i++) {
                    if (pages[i] !== '.') {
                        if (pages[i] !== currentPage) {
                            myPagination.appendChild(getLink(pages[i]));
                            myPagination.appendChild(getSpace());
                        }
                        else {
                            myPagination.appendChild(getEmptyLink(pages[i]));
                            myPagination.appendChild(getSpace());
                        }
                    }
                    else { 
                        myPagination.appendChild(getSelect(pages[i-1]+1, pages[i+1]-1));
                        myPagination.appendChild(getSpace());
                    }
                }
            }
            function getLink(page) {
                let link = document.createElement("a");
                link.setAttribute("href","#");
                link.setAttribute("onclick", `navigate(${page})`);
                link.setAttribute("class", "pagination-link");
                link.innerHTML = `${page}`;
                return link;
            }
            function getEmptyLink(page) {
                let link = document.createElement("span");
                link.setAttribute("class", "pagination-current");
                link.innerHTML = `${page}`;
                return link;
            }
            function getSpace() {
                let space = document.createElement("span");
                space.innerHTML = "&nbsp;";
                return space;
            }
            function getSelect(minPage, maxPage) {
                let sel = document.createElement("select");
                sel.setAttribute("onchange", "navigate(this.value)");
                let optDefault = document.createElement("option");
                optDefault.value = 0;
                optDefault.innerHTML = "...";
                sel.appendChild(optDefault);
                for (let i = minPage; i <= maxPage; i++) {
                    let opt = document.createElement("option");
                    opt.value = i;
                    opt.innerHTML = i;
                    sel.appendChild(opt);
                }
                return sel;
            }
            function navigate(page) {
                document.getElementById("CurrentPage").value = page;
                populatePagination();
            }
        </script>
        <div id="myPagination"></div>
        <input id="CurrentPage" type="hidden" value="1" />
        <input id="PageCount" type="hidden" value="20" />
    </body>
</html>
